<svg xmlns="http://www.w3.org/2000/svg" width="1050" height="600" viewBox="0 0 1050 600">
  <style>
    text { font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; }
    .layer-label { font-size: 15px; fill: #000; font-weight: 500; }
    .layer-desc { font-size: 13px; fill: #555; }
    .layer-num { font-size: 13px; fill: #fff; font-weight: 600; }
    .bracket-label { font-size: 13px; fill: #000; font-weight: 500; }
    .title { font-size: 16px; fill: #000; font-weight: 600; }
    .caption { font-size: 12px; fill: #666; }
    .side-label { font-size: 13px; fill: #333; font-weight: 500; }
  </style>

  <defs>
    <marker id="arrowGray" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6" fill="#555"/>
    </marker>
  </defs>

  <!-- Title -->
  <text x="525" y="35" text-anchor="middle" class="title">Figure 1: The Five-Layer Agent Memory Stack</text>

  <!-- Layer 5 (top) - Active working context -->
  <rect x="160" y="60" width="580" height="70" rx="4" fill="#1a1a1a" stroke="#000" stroke-width="1.5"/>
  <circle cx="200" cy="95" r="14" fill="#000" stroke="#fff" stroke-width="1"/>
  <text x="200" y="100" text-anchor="middle" class="layer-num">5</text>
  <text x="230" y="88" class="layer-label" fill="#fff">Active working context</text>
  <text x="230" y="108" class="layer-desc" fill="#aaa">Warm-start state · SHARED-CONTEXT.md · &lt;50 lines</text>

  <!-- Arrow down -->
  <line x1="450" y1="130" x2="450" y2="138" stroke="#555" stroke-width="1.5" marker-end="url(#arrowGray)"/>

  <!-- Layer 4 - Narrative consolidation -->
  <rect x="160" y="140" width="580" height="70" rx="4" fill="#333" stroke="#000" stroke-width="1.5"/>
  <circle cx="200" cy="175" r="14" fill="#000" stroke="#fff" stroke-width="1"/>
  <text x="200" y="180" text-anchor="middle" class="layer-num">4</text>
  <text x="230" y="168" class="layer-label" fill="#fff">Narrative consolidation</text>
  <text x="230" y="188" class="layer-desc" fill="#aaa">Dream Weaver output · ~8K words · first-person narrative</text>

  <!-- Bracket for layers 4-5: "Dream Weaver" -->
  <line x1="760" y1="68" x2="785" y2="68" stroke="#000" stroke-width="1.5"/>
  <line x1="785" y1="68" x2="785" y2="202" stroke="#000" stroke-width="1.5"/>
  <line x1="760" y1="202" x2="785" y2="202" stroke="#000" stroke-width="1.5"/>
  <text x="800" y="130" class="bracket-label">Dream</text>
  <text x="800" y="147" class="bracket-label">Weaver</text>

  <!-- Divider line -->
  <line x1="180" y1="225" x2="720" y2="225" stroke="#999" stroke-width="1" stroke-dasharray="6,4"/>
  <text x="525" y="245" text-anchor="middle" class="caption">— most systems stop here —</text>

  <!-- Layer 3 - Structured memory -->
  <rect x="160" y="260" width="580" height="70" rx="4" fill="#888" stroke="#000" stroke-width="1.5"/>
  <circle cx="200" cy="295" r="14" fill="#555" stroke="#fff" stroke-width="1"/>
  <text x="200" y="300" text-anchor="middle" class="layer-num">3</text>
  <text x="230" y="288" class="layer-label" fill="#fff">Structured memory</text>
  <text x="230" y="308" class="layer-desc" fill="#e8e8e8">Facts, preferences, entities · explicit remember/forget</text>

  <!-- Arrow down -->
  <line x1="450" y1="330" x2="450" y2="338" stroke="#555" stroke-width="1.5" marker-end="url(#arrowGray)"/>

  <!-- Layer 2 - Vector index -->
  <rect x="160" y="340" width="580" height="70" rx="4" fill="#aaa" stroke="#000" stroke-width="1.5"/>
  <circle cx="200" cy="375" r="14" fill="#777" stroke="#fff" stroke-width="1"/>
  <text x="200" y="380" text-anchor="middle" class="layer-num">2</text>
  <text x="230" y="368" class="layer-label" fill="#fff">Vector index</text>
  <text x="230" y="388" class="layer-desc" fill="#e8e8e8">Embedding-based retrieval · BM25 + cosine · hybrid search</text>

  <!-- Arrow down -->
  <line x1="450" y1="410" x2="450" y2="418" stroke="#555" stroke-width="1.5" marker-end="url(#arrowGray)"/>

  <!-- Layer 1 (bottom) - Raw transcripts -->
  <rect x="160" y="420" width="580" height="70" rx="4" fill="#ccc" stroke="#000" stroke-width="1.5"/>
  <circle cx="200" cy="455" r="14" fill="#999" stroke="#fff" stroke-width="1"/>
  <text x="200" y="460" text-anchor="middle" class="layer-num">1</text>
  <text x="230" y="448" class="layer-label">Raw transcripts</text>
  <text x="230" y="468" class="layer-desc">Immutable log · JSONL session files · ground truth</text>

  <!-- Bracket for layers 1-3: "Standard RAG" -->
  <line x1="760" y1="268" x2="785" y2="268" stroke="#000" stroke-width="1.5"/>
  <line x1="785" y1="268" x2="785" y2="482" stroke="#000" stroke-width="1.5"/>
  <line x1="760" y1="482" x2="785" y2="482" stroke="#000" stroke-width="1.5"/>
  <text x="800" y="370" class="bracket-label">Standard</text>
  <text x="800" y="387" class="bracket-label">RAG</text>

  <!-- Left labels -->
  <text x="140" y="95" text-anchor="end" class="side-label">continuity</text>
  <text x="140" y="175" text-anchor="end" class="side-label">identity</text>
  <text x="140" y="295" text-anchor="end" class="side-label">recall</text>
  <text x="140" y="375" text-anchor="end" class="side-label">retrieval</text>
  <text x="140" y="455" text-anchor="end" class="side-label">truth</text>

  <!-- Caption -->
  <text x="525" y="530" text-anchor="middle" class="caption">Layers 1–3 solve recall. Layers 4–5 solve continuity.</text>
  <text x="525" y="548" text-anchor="middle" class="caption">Most current work optimizes layers 1–3. The Dream Weaver Protocol addresses the gap.</text>
</svg>